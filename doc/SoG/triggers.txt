#
# $Id: triggers.txt,v 1.10 2003-07-21 19:12:48 fjoe Exp $
#

  Для всех триггеров, исключая mob_death, mob_fight, mob_kill если первым
символом trig_arg не является '+', то триггер не срабатывает, если моб не
находится в default позиции.
Если первым символом trig_arg является '+', то позиция моба не проверяется,
а этот символ '+' пропускается в дальнейших проверках.
  Для всех триггеров, если retval > 0, другие триггера этого типа (если они
есть) не зовутся.
  Для всех obj прог $p -- объект, на котором срабатывает триггер.
  Для всех mob прог $n -- моб, для которого зовется прога.

 trigger   | trig_arg  | mprog retval    | срабатывает
===========+===========+=================+======================================
mob_death  |вероятность| при retval > 0  | при смерти моба
           |           | raw_kill не     |
           |           | зовется         |
-----------+-----------+-----------------+--------------------------------------
mob_entry  |вероятность| игнорируется    | когда моб куда-либо заходит
-----------+-----------+-----------------+--------------------------------------
mob_fight  |вероятность| игнорируется    | каждый battle round
-----------+-----------+-----------------+--------------------------------------
mob_kill   |вероятность| при retval > 0  | при нападении на моба
           |           |бой не начинается|
-----------+-----------+-----------------+--------------------------------------
mob_random |вероятность| игнорируется    | при update mobile
-----------+-----------+-----------------+--------------------------------------
mob_delay  |вероятность| игнорируется    |
-----------+-----------+-----------------+--------------------------------------
mob_look   |вероятность| игнорируется    | при look на моба
-----------+-----------+-----------------+--------------------------------------
mob_give   | объект*   | игнорируется    | когда мобу дается указанный объект
-----------+-----------+-----------------+--------------------------------------
mob_open   | объект*   | игнорируется    | при открытии при мобе объекта
-----------+-----------+-----------------+--------------------------------------
mob_get    | объект*   | игнорируется    | 
-----------+-----------+-----------------+--------------------------------------
mob_tell   | строка**  | игнорируется    | когда мобу говорится (tell) строка
-----------+-----------+-----------------+--------------------------------------
mob_speech | строка**  | игнорируется    | когда мобу говорится (tell) или
           |           |                 | при нем произносится (say) строка
-----------+-----------+-----------------+--------------------------------------
mob_act    | строка**  | игнорируется    |
-----------+-----------+-----------------+--------------------------------------
mob_yell   | строка**  | игнорируется    | когда моб слышит yell
-----------+-----------+-----------------+--------------------------------------
mob_greet  | выход     | игнорируется    | при появлении в комнате с мобом
-----------+-----------+-----------------+--------------------------------------
mob_exit   |выход (all,| при retval > 0  | когда покидают комнате через
           |south, east| перемещения чара| указанный выход
           |up, down..)| не происходит   |
-----------+-----------+-----------------+--------------------------------------
mob_bribe  |сумма      |retval > 0 деньги| когда мобу дается указанная сумма  
           | (silver)  | деньги мобу не  |
           |           | добавляются     |
-----------+-----------+-----------------+--------------------------------------
mob_cmd    | комманда  | игнорируется    | когда исполняется при мобе комманда
==========+===========+=================+=======================================
obj_damage |вероятность| при retval > 0  | при нанесение урона по объекту
           |           | dam не наносится| $n - владелец 
-----------+-----------+-----------------+--------------------------------------
obj_repair |вероятность| при retval > 0  | при попытке починить объект
           |           | obj не чинится  | $n - владелец
-----------+-----------+-----------------+--------------------------------------
obj_wear   |вероятность| при retval > 0  | при попытке одеть объект
           |           | не одевается    |
-----------+-----------+-----------------+--------------------------------------
obj_remove |вероятность| при retval > 0  | при попытке снять объект
           |           | не снимается    |
-----------+-----------+-----------------+--------------------------------------
obj_drop   |вероятность| игнорируется    | при попытке бросить объект
-----------+-----------+-----------------+--------------------------------------
obj_sac    |вероятность| при retval > 0  | при попытке принести объект в жертву
           |           | объект в жертву |
           |           | не приносится   |
-----------+-----------+-----------------+--------------------------------------
obj_greet  |вероятность| игнорируется    | кто-то появляется там, где объект
-----------+-----------+-----------------+--------------------------------------
obj_fight  |вероятность| игнорируется    | каждый battle round
-----------+-----------+-----------------+--------------------------------------
obj_death  |вероятность| при retval > 0  | при смерти того, на ком одет
           |           | raw_kill не     |
           |           | зовется         |
-----------+-----------+-----------------+--------------------------------------
obj_entry  |вероятность| игнорируется    | объект заносится
-----------+-----------+-----------------+--------------------------------------
obj_get    |вероятность| игнорируется    | при попытке поднять
-----------+-----------+-----------------+--------------------------------------
obj_random |вероятность| игнорируется    | каждый маленький тик
-----------+-----------+-----------------+--------------------------------------
obj_look   |вероятность| игнорируется    | при look на объект
-----------+-----------+-----------------+--------------------------------------
obj_enter  |вероятность| если retval > 0 | при входе в объект (портал)
           |           |действие(вход) не|
           |           | исполняется     |
-----------+-----------+-----------------+--------------------------------------
obj_open   |вероятность| если retvil > 0 | при открывании объекта
           |           | объект не       |
           |           | открывается     |
-----------+-----------+-----------------+--------------------------------------
obj_close  |вероятность| если retvil > 0 | при закрывании объекта
           |           | объект не       |
           |           | закрывается     |
-----------+-----------+-----------------+--------------------------------------
obj_unlock |вероятность| если retvil > 0 | при отмыкании объекта
           |           |obj не отмыкается|
-----------+-----------+-----------------+--------------------------------------
obj_lock   |вероятность| если retvil > 0 | при замыкании объекта
           |           |obj не замыкается|
-----------+-----------+-----------------+--------------------------------------
obj_give   | объект*   | игнорируется    | при передаче объекта
-----------+-----------+-----------------+--------------------------------------
obj_speech | строка**  | игнорируется    | при произнесении строки
-----------+-----------+-----------------+--------------------------------------
obj_cmd    | команда   | игнорируется    | при исполнении команды
-----------+-----------+-----------------+--------------------------------------
obj_use    |вероятность|при retval > 0 не| при brandish для staff, zap для wand,
	   |	       | используется    | quaff для potion, recite для scroll
	   |	       |		 | read для books
===========+===========+=================+======================================
room_random|вероятность| игнорируется    | при update room с указанной вероят-ю
-----------+-----------+-----------------+--------------------------------------
room_cmd   | команда   | игнорируется    | при исполнении команды в комнате
-----------+-----------+-----------------+--------------------------------------
room_greet |направление| игнорируется    | при входе в комнату с указаню стороны
-----------+-----------+-----------------+--------------------------------------
room_dopen | dir (name)|при retval > 0 не| при попытке открыть указанную дверь
	   |           | открывается     |
-----------+-----------+-----------------+--------------------------------------
room_dclose| dir (name)|при retval > 0 не| при попытке закрыть указанную дверь
	   |           | закрывается     |
-----------+-----------+-----------------+--------------------------------------
room_dlock | dir (name)|при retval > 0 не| при попытке замкнуть указанную дверь
	   |           | замыкается      |
-----------+-----------+-----------------+--------------------------------------
room_dunlock|dir (name)|при retval > 0 не| при попытке отомкнуть указанную дверь
	   |           | замыкается      |
===========+===========+=================+======================================
TRIG_SPEC  |           |                 |
===========+===========+=================+======================================

*  -- vnum или название (name)
** -- Если trig_arg начинается с '#', то остальная часть trig_arg
рассматривается как regexp и arg должен соответствовать этому regexp.
В противном случае триггер срабатывает, если trig_arg является подстрокой arg.
Если trig_arg содержит прописные буквы, то сравнения в обоих случаях (и
в случае regexp и в простом случае) производятся с учетом регистра, если
только строчные, то без учета регистра.
